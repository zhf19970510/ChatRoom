##多线程

- [x] 理解线程的概念
- [x] 掌握线程的创建和启动
- [x] 了解线程的状态
- [x] 掌握线程调度的常用方法
- [x] 掌握线程的同步



文件流:

```
1.文件递归？
删除非空文件夹
或者通过递归打印一个非空文件夹目录下所有的字幕文件或者文件夹名字

2.字节流
3.字符流
4.字符缓冲流
5.对象流
6.字节与字符转换流
。。。。
poi技术 ：解析Excel文件的 ？  

```


### 一丶理解多线程概念

```java
程序：程序员编写的就是程序。。。。。(由一些列指令集合组成)  占用硬盘空间。。而非内存。。。。
程序运行起来了，，，，占用内存  服务里面会生成进程。。。。

线程？ 程序执行的一个流程  (说白了就是程序执行的路径。。。)

多线程? 程序拥有多个执行的流程 (说白了程序拥有多个执行路径)

1、一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程。线程是操作系统可识别的最小执行和调度单位。


注意:
<1>.多个线程交替占用CPU资源，而非真正的并行执行(同时运行)   并发执行(拥有时间间隔，但是时间极短  小于1ms)
    
<2>: mian 方法实际上就是一个线程(主线程)
   //main方法时主线程
	public static void main(String[] args) {
		/*//获取当前处于运行状态的线程对象
		Thread nowThread=Thread.currentThread();
		//默认线程名字为方法名:mian
		nowThread.setName("主线程");
		System.out.println(nowThread.getName());*/
	}
  主线程的默认名字是：main 
  线程的名字可以修改
  子线程也会有默认名字:thread-0 thread-1  thread-2.....
  子线程名字也可以修改。。。。 
```

##二丶常用的线程的创建和启动

```java
在Java中创建线程的两种方式
继承java.lang.Thread类
实现java.lang.Runnable接口
<1>.分别使用继承 Thread  以及  实现 Runnable 接口的方式实现多线程程序
```

####2.1比较2种创建线程的方式:

```java
<1>.继承Thread类
编写简单，可直接操作线程
适用于单继承
<2>.实现Runnable接口
避免单继承局限性
便于共享资源

总结java属于多实现   单继承
多线程实现网络购票，用户提交购票信息后
第一步：网站修改网站车票数据
第二步：显示出票反馈信息给用户
```



###三丶了解线程的状态

```java
线程状态
与人有生老病死一样，线程也同样要经历新建、就绪、运行(活动)、阻塞和死亡五种不同的状态。这五种状态都可以通过Thread类中的方法进行控制。

<1>.新建状态 (New Thread)
在 Java 语言中使用 new 操作符创建一个线程后，该线程仅仅是一个空对象，它具备了线程的一些特征，但此时系统没有为其分配资源，这时的线程处于创建状态。

<2>.就绪状态 (Runnable)
使用 start() 方法启动一个线程后，系统为该线程分配了除 CPU 外的所需资源，使该线程处于就绪状态。

<3>.运行状态 (Running)
Java 运行系统通过调度选中一个处于就绪状态的线程，使其占有 CPU 并转为运行状态。此时，系统真正执行线程的 run() 方法。

<4>.阻塞状态 (Blocked)一个正在运行的线程因某些原因不能继续运行时，就进入阻塞状态。

<5>.死亡状态 (Dead)
线程在 run() 方法执行结束后进入死亡状态。

```

### 四丶线程调度的常用方法

```java
1.线程调度指按照特定机制为多个线程分配CPU的使用权
<1>.setPriority(int  newPriority) 更改线程的优先级
注意:线程优先级由1~10表示，1最低，默认优先级为5
优先级高的线程获得CPU资源的概率较大（但不能保证一定会分配资源）

cpu会尽可能的优先分配资源给优先级相对较高的线程
th01   1
th02   10
cpu大概率优先加载  线程2  th02 
也有可能先加载  线程1  th01

<2>(*).static void sleep(long millis) 在指定的毫秒数内让当前正在执行的线程休眠  定时
<3>(*).void join()  等待该线程终止   让出CPU资源  给其他线程使用
注意:使当前线程暂停执行，等待其他线程结束后再继续执行本线程

<4>.static void yield() 暂停当前正在执行的线程对象，并执行其他线程
注意:暂停当前线程，允许其他具有相同优先级的线程获得运行机会
该线程处于就绪状态，不转为阻塞状态

特别注意:只是提供一种可能，但是不能保证一定会实现礼让

<5>.void interrupt() 中断线程
<6>.boolean isAlive() 测试线程是否处于活动状态
stop 


案例1：
需求说明
某科室一天需看普通号50个 线程1  ， 特需号10个线程2
特需号看病时间是普通号的2倍(sleep)
开始时普通号和特需号并行叫号，叫到特需号的概率比普通号高  setPriority(1-10)
当普通号叫完第10号时，要求先看完全部特需号，再看普通号   join( ms)
使用多线程模拟这一过程


```



###五丶线程同步案例分析

线程同步的基本概念:

```
	java允许多线程并发控制，当多个线程同时操作一个可共享的资源变量时（如数据的增删改查），将会导致数据不准确，相互之间产生冲突，因此加入同步锁以避免在该线程没有完成操作之前，被其他线程的调用，从而保证了该变量的唯一性和准确性。
	
	
	1张票
	10个用户去抢  10个线程。。。。  
	ArrayList  : 异步  线程不安全  速度快  使用单线程
	Vector  : 同步  线程安全。。。 速度慢   适合用于多线程
	
	StringBuider :  异步  线程不安全  速度快  使用单线程
	StringBuffer:同步  线程安全。。。 速度慢   适合用于多线程
	
```

1.使用同步方法实现同步

```java
  即有synchronized关键字修饰的方法。由于java的每个对象都有一个内置锁，当用此关键字修饰方法时，内置锁会保护整个方法。在调用该方法前，需要获得内置锁，否则就处于阻塞状态。
  集合size+1   里面的元素就会增加2  。。出现
  public synchronized  void save(){    //2个线程同时添加一个元素  
  
  	//当有一个线程执行此方法的时候  别的线程就不可以执行此方法
  }
 注： synchronized关键字也可以修饰静态方法，此时如果调用该静态方法，将会锁住整个类
 
 使用同步代块
 synchronized（Object obj）{ //当有一个线程执行此逻辑代码块的时候 别的 线程就不可以执行
 	逻辑代码
 }
 
```

2.使用重入锁（Lock）实现线程同步

```
  在JavaSE5.0中新增了一个java.util.concurrent包来支持同步。ReentrantLock类是可重入、互斥、实现了Lock接口的锁，它与使用synchronized方法和快具有相同的基本行为和语义，并且扩展了其能力。ReenreantLock类的常用方法有：    
 ReentrantLock() : 创建一个ReentrantLock实例         
 lock() : 获得锁   
 	逻辑操作
 unlock() : 释放锁
 
注：ReentrantLock()还有一个可以创建公平锁的构造方法，但由于能大幅度降低程序运行效率，不推荐使用

```

3.案例分析:

```
某银行卡账号上有500元现金。一个人拿着存折去取钱，同时另一个人拿着卡去ATM上取钱，各自取钱400元。
要求取钱过程中不能出现资源竞争：比如400元被取出两次、银行卡的账目不能小于0等。

if(money>num){// 2个线程同时执行 
    //
}

一个人拿着存折去取钱 等价于1个线程  取钱成功 400
另一个人拿着卡去ATM上取钱  等价于另一个线程  取钱成功400

频繁滥用synchronized 同步代码块可能会出现一种常见的问题 比如线程死锁。。。

线程死锁：2个线程 互相等待对方释放对象锁的过程我们称之为 死锁。。。

```

六丶线程通信

```java
1、借助于Object类的wait()、notify()和notifyAll()实现通信
线程执行wait()后，就放弃了运行资格，处于冻结状态；
线程运行时，内存中会建立一个线程池，冻结状态的线程都存在于线程池中，notify()执行时唤醒的也是线程池中的线程，线程池中有多个线程时唤醒第一个被冻结的线程。
notifyall(), 唤醒线程池中所有线程。
注：（1）wait(), notify(),notifyall()都用在同步里面，因为这3个函数是对持有锁的线程进行操作，而只有同步才有锁，所以要使用在同步中；
    （2）wait(),notify(),notifyall(),  在使用时必须标识它们所操作的线程持有的锁，因为等待和唤醒必须是同一锁下的线程；而锁可以是任意对象，所以这3个方法都是Object类中的方法。
    
    
```



POI解析技术。。。

```
专门用于读取以及解析Excel的一门技术。。。

通过 文件可以创建一个Excel文件，但是 Excel结构 很复杂无法直接往里面编辑内容
一个Excel由 工作空间  sheet 以及 行 还有列组成

EXcel组成部分：
1.由多个sheet 组成（多个工作空间组成）
2.1个sheet由多个行组成
3.1个行又有多个列组成。。。。



```





